(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["home_wellcome"],{"0bfb":function(t,e,a){"use strict";var i=a("cb7c");t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"1af6":function(t,e,a){var i=a("63b6");i(i.S,"Array",{isArray:a("9003")})},"1c16":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"selectItem"},[a("el-form",{ref:"selectForm",attrs:{model:t.selectForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"类型筛选"}},[a("el-cascader",{staticStyle:{width:"95%"},attrs:{options:t.devTypeList,props:{expandTrigger:"hover",value:"devTypeId",label:"devTypeName"},placeholder:"请选择设备类型",clearable:""},on:{change:t.chooseType},model:{value:t.devType,callback:function(e){t.devType=e},expression:"devType"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.major&&"VEHICLE"!==t.major,expression:"major && major!=='VEHICLE'"}],attrs:{label:"所属线路"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择设备主类"},on:{change:t.getDev},model:{value:t.lineCode,callback:function(e){t.lineCode=e},expression:"lineCode"}},t._l(t.lineList,(function(t){return a("el-option",{key:t.lineCode,attrs:{label:t.lineName,value:t.lineCode}})})),1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.major&&"VEHICLE"!==t.major,expression:"major && major!=='VEHICLE'"}],attrs:{label:"所属车站"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择设备主类"},on:{change:t.getDev},model:{value:t.stationCode,callback:function(e){t.stationCode=e},expression:"stationCode"}},t._l(t.stationList,(function(t){return a("el-option",{key:t.stationCode,attrs:{label:t.stationName,value:t.stationCode}})})),1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"==t.major,expression:"major=='VEHICLE'"}],attrs:{label:"所属车辆"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择设备子类"},on:{change:t.getDev},model:{value:t.trainCode,callback:function(e){t.trainCode=e},expression:"trainCode"}},t._l(t.trainList,(function(t){return a("el-option",{key:t.trainId,attrs:{label:t.trainId,value:t.trainId}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"设备筛选"}},[a("el-input",{staticStyle:{width:"95%"},on:{change:t.getDev},model:{value:t.devName,callback:function(e){t.devName=e},expression:"devName"}})],1)],1),t._v(" "),a("div",{staticClass:"devList"},[a("ul",t._l(t.devList,(function(e){return a("li",{key:e.devId,class:e.active?"active":"",on:{click:function(a){return t.chooseDev(e)}}},[t._v(t._s(e.devName))])})),0)])],1),t._v(" "),a("div",{staticClass:"attr"},[a("div",{staticClass:"attr-table"},[a("el-table",{ref:"attrList",staticStyle:{width:"100%",height:"100%",overflow:"auto"},attrs:{"highlight-current-row":"",data:t.attrList,"tooltip-effect":"dark"},on:{"selection-change":t.selectAttr}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),t._v(" "),a("el-table-column",{attrs:{prop:"RES_TYPE_NAME",label:"采集项"}}),t._v(" "),a("el-table-column",{attrs:{prop:"SRC_NAME",label:"来源","show-overflow-tooltip":""}})],1)],1)])]),t._v(" "),t.panels.length>0?a("div",{staticClass:"table-content"},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}})],1),t._v(" "),a("iframe",{attrs:{name:"refresh_name",src:"http://192.168.0.103:3000/d/"+t.uid+"/"+t.slug+"?kiosk",title:"grafanaPanel",width:"100%",height:"800px"}})]):t._e()])},s=[],n=a("85f2"),r=a.n(n);function o(t,e,a){return e in t?r()(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}a("6b54"),a("ac6a");var l,d=(l={name:"charts",data:function(){return{value1:[new Date(2e3,10,10,10,10),new Date(2e3,10,11,10,10)],major:null,showTable:!1,typeId:null,topCheck:!0,selectForm:{name:"",region:""},attr:[{uid:"",slug:""}],dbSrc:{SIG:"SIG",BAS:"BAS",VEHICLE:"TRAIN"},dbList:{SIG:{0:"SIG_DIGIT",1:"SIG_ENUM",2:"SIG_ANALOG"},BAS:{0:"BAS_DIGIT",2:"BAS_ANALOG"},VEHICLE:{0:"TRAIN_DIGIT",2:"TRAIN_ANALOG"}},lineList:[],stationList:[],trainList:[],trainCode:"",lineCode:"",stationCode:"",devTypeList:[],devType:"",devName:"",devAllList:[],devList:[],attrList:[],dashboard:[],panels:[],slug:"",uid:""}},watch:{},mounted:function(){this.getLine(),this.getStation(),this.getTrain(),this.initDashboard(),this.getDevTypeList()}},o(l,"watch",{devName:function(t){this.devList=this.devAllList,this.devList=this.devAllList.filter((function(e){return-1!==e.devName.indexOf(t)}))}}),o(l,"methods",{getLine:function(){var t=this;this.$.ajax({url:"/devdata/linelist",type:"get",success:function(e){t.lineList=e.data}})},getStation:function(){var t=this;this.$.ajax({url:"/devdata/stationlist",type:"get",success:function(e){t.stationList=e.data}})},getTrain:function(){var t=this;this.$.ajax({url:"/devdata/trainlist",type:"get",success:function(e){t.trainList=e.data}})},initDashboard:function(){var t=this;this.$.ajax({url:"/api/dashboards/db/xing",type:"get",success:function(e){var a=e.dashboard;a.panels=[],t.updateDashboard(a)}})},updateDashboard:function(t){var e={dashboard:t,message:"reset",overwrite:!1},a=this;this.$.ajax({url:"/api/dashboards/db",type:"post",contentType:"application/json",data:JSON.stringify(e),success:function(t){a.getDashboard()}})},getDashboard:function(){var t=this;this.$.ajax({url:"/api/dashboards/db/xing",type:"get",success:function(e){t.dashboard=e.dashboard,t.slug=e.dashboard.title,t.uid=e.dashboard.uid,t.panels=e.dashboard.panels}})},getDevTypeList:function(){var t=this;this.$.ajax({url:"/devdata/listdevtype",type:"post",success:function(e){var a=e.data;a.forEach((function(t){t.devTypeId=t.devMainTypeId,t.devTypeName=t.devMainTypeName,t.children=t.sysDevTypeDefVoList}));var i=[{devTypeId:"SIG",devTypeName:"信号"},{devTypeId:"VEHICLE",devTypeName:"车辆"},{devTypeId:"BAS",devTypeName:"水泵"}];for(var s in a)for(var n in i)i[n].devTypeId===a[s].major&&(i[n].children=i[n].children?i[n].children:[],i[n].children.push(a[s]));t.devTypeList=[],t.devTypeList=i}})},chooseType:function(t){if(t&&0===t.length)return this.devId=null,this.devAllList=[],this.devList=[],this.attrList=[],void(this.tableData=[]);this.major=t[0],this.typeId=t[2],t[2]&&this.getDev()},getDev:function(t){var e,a=this;if(this.major){if("VEHICLE"!==this.major&&this.stationCode)e=this.stationCode;else{if("VEHICLE"!=this.major||!this.trainCode)return a.devId=null,a.devAllList=[],a.devList=[],a.attrList=[],void(a.tableData=[]);e=this.trainCode}this.$.ajax({url:"/devdata/listdev",type:"post",data:{stationCode:e,typeid:a.typeId,start:0,limit:1e3},success:function(t){t.data&&t.data.records&&t.data.records.length>0?(a.devAllList=t.data.records,a.devList=t.data.records,a.devId=t.data.records[0].devId):(a.devId=null,a.devAllList=[],a.devList=[],a.attrList=[])}})}},chooseDev:function(t){var e=t.devId,a=this.devList;a.forEach((function(t){e===t.devId&&1==t.active?t.active=!1:e===t.devId?t.active=!0:t.active=!1})),this.devList=[],this.devList=a,this.getAttr(t.devId)},getAttr:function(t){var e=this;this.$.ajax({url:"/devdata/listdevattr",type:"post",data:{devid:t},success:function(t){t.data.forEach((function(t,e){t.sort=e.toString()})),e.attrList=t.data}})},selectAttr:function(t){console.log(panels)}}),l),c=d,u=(a("d56d"),a("2877")),v=Object(u["a"])(c,i,s,!1,null,"77b02034",null);e["default"]=v.exports},"20fd":function(t,e,a){"use strict";var i=a("d9f6"),s=a("aebd");t.exports=function(t,e,a){e in t?i.f(t,e,s(0,a)):t[e]=a}},"2f21":function(t,e,a){"use strict";var i=a("79e5");t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"2ffb":function(t,e,a){"use strict";a.r(e),e["default"]={aliasColors:{},bars:!1,dashLength:10,dashes:!1,datasource:"",fill:1,fillGradient:0,gridPos:{h:9,w:12,x:0,y:0},hiddenSeries:!1,id:2,legend:{avg:!1,current:!1,max:!1,min:!1,show:!0,total:!1,values:!1},lines:!0,linewidth:1,nullPointMode:"null",options:{dataLinks:[]},percentage:!1,pointradius:2,points:!1,renderer:"flot",seriesOverrides:[],spaceLength:10,stack:!1,steppedLine:!1,targets:[{groupBy:[],measurement:"win_cpu",orderByTime:"ASC",policy:"1_day",refId:"A",resultFormat:"time_series",select:[[{params:["value"],type:"field"}]],tags:[{key:"instance",operator:"=",value:"_Total"}]}],thresholds:[],timeFrom:null,timeRegions:[],timeShift:null,title:"test",tooltip:{shared:!0,sort:0,value_type:"individual"},type:"graph",xaxis:{buckets:null,mode:"time",name:null,show:!0,values:[]},yaxes:[{format:"short",label:null,logBase:1,max:null,min:null,show:!0},{format:"short",label:null,logBase:1,max:null,min:null,show:!0}],yaxis:{align:!1,alignLevel:null}}},3702:function(t,e,a){var i=a("481b"),s=a("5168")("iterator"),n=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||n[s]===t)}},3846:function(t,e,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"40c3":function(t,e,a){var i=a("6b4c"),s=a("5168")("toStringTag"),n="Arguments"==i(function(){return arguments}()),r=function(t,e){try{return t[e]}catch(a){}};t.exports=function(t){var e,a,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(a=r(e=Object(t),s))?a:n?i(e):"Object"==(o=i(e))&&"function"==typeof e.callee?"Arguments":o}},"454f":function(t,e,a){a("46a7");var i=a("584a").Object;t.exports=function(t,e,a){return i.defineProperty(t,e,a)}},"456d":function(t,e,a){var i=a("4bf8"),s=a("0d58");a("5eda")("keys",(function(){return function(t){return s(i(t))}}))},"46a7":function(t,e,a){var i=a("63b6");i(i.S+i.F*!a("8e60"),"Object",{defineProperty:a("d9f6").f})},4808:function(t,e,a){},"4ee1":function(t,e,a){var i=a("5168")("iterator"),s=!1;try{var n=[7][i]();n["return"]=function(){s=!0},Array.from(n,(function(){throw 2}))}catch(r){}t.exports=function(t,e){if(!e&&!s)return!1;var a=!1;try{var n=[7],o=n[i]();o.next=function(){return{done:a=!0}},n[i]=function(){return o},t(n)}catch(r){}return a}},"549b":function(t,e,a){"use strict";var i=a("d864"),s=a("63b6"),n=a("241e"),r=a("b0dc"),o=a("3702"),l=a("b447"),d=a("20fd"),c=a("7cd6");s(s.S+s.F*!a("4ee1")((function(t){Array.from(t)})),"Array",{from:function(t){var e,a,s,u,v=n(t),h="function"==typeof this?this:Array,f=arguments.length,p=f>1?arguments[1]:void 0,g=void 0!==p,m=0,b=c(v);if(g&&(p=i(p,f>2?arguments[2]:void 0,2)),void 0==b||h==Array&&o(b))for(e=l(v.length),a=new h(e);e>m;m++)d(a,m,g?p(v[m],m):v[m]);else for(u=b.call(v),a=new h;!(s=u.next()).done;m++)d(a,m,g?r(u,p,[s.value,m],!0):s.value);return a.length=m,a}})},"54a1":function(t,e,a){a("6c1c"),a("1654"),t.exports=a("95d5")},"55dd":function(t,e,a){"use strict";var i=a("5ca1"),s=a("d8e8"),n=a("4bf8"),r=a("79e5"),o=[].sort,l=[1,2,3];i(i.P+i.F*(r((function(){l.sort(void 0)}))||!r((function(){l.sort(null)}))||!a("2f21")(o)),"Array",{sort:function(t){return void 0===t?o.call(n(this)):o.call(n(this),s(t))}})},"5eda":function(t,e,a){var i=a("5ca1"),s=a("8378"),n=a("79e5");t.exports=function(t,e){var a=(s.Object||{})[t]||Object[t],r={};r[t]=e(a),i(i.S+i.F*n((function(){a(1)})),"Object",r)}},"603b":function(t,e,a){},"67bb":function(t,e,a){t.exports=a("f921")},"6b54":function(t,e,a){"use strict";a("3846");var i=a("cb7c"),s=a("0bfb"),n=a("9e1e"),r="toString",o=/./[r],l=function(t){a("2aba")(RegExp.prototype,r,t,!0)};a("79e5")((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?l((function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?s.call(t):void 0)})):o.name!=r&&l((function(){return o.call(this)}))},"76b1":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"selectItem"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.formLoading,expression:"formLoading"}],ref:"selectForm",attrs:{model:t.selectForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"类型筛选"}},[a("el-cascader",{staticStyle:{width:"95%"},attrs:{options:t.devTypeList,props:{expandTrigger:"hover",value:"devTypeId",label:"devTypeName"},placeholder:"请选择设备类型",clearable:""},on:{change:t.chooseType},model:{value:t.devType,callback:function(e){t.devType=e},expression:"devType"}})],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.major&&"VEHICLE"!==t.major,expression:"major && major!=='VEHICLE'"}],attrs:{label:"所属线路"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择设备主类"},on:{change:t.getDev},model:{value:t.lineCode,callback:function(e){t.lineCode=e},expression:"lineCode"}},t._l(t.lineList,(function(t){return a("el-option",{key:t.lineCode,attrs:{label:t.lineName,value:t.lineCode}})})),1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.major&&"VEHICLE"!==t.major,expression:"major && major!=='VEHICLE'"}],attrs:{label:"所属车站"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择设备主类"},on:{change:t.getDev},model:{value:t.stationCode,callback:function(e){t.stationCode=e},expression:"stationCode"}},t._l(t.stationList,(function(t){return a("el-option",{key:t.stationCode,attrs:{label:t.stationName,value:t.stationCode}})})),1)],1),t._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"==t.major,expression:"major=='VEHICLE'"}],attrs:{label:"所属车辆"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择设备子类"},on:{change:t.getDev},model:{value:t.trainCode,callback:function(e){t.trainCode=e},expression:"trainCode"}},t._l(t.trainList,(function(t){return a("el-option",{key:t.trainId,attrs:{label:t.trainId,value:t.trainId}})})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"设备筛选"}},[a("el-input",{staticStyle:{width:"95%"},on:{change:t.getDev},model:{value:t.devName,callback:function(e){t.devName=e},expression:"devName"}})],1)],1),t._v(" "),a("div",{staticClass:"devList"},[a("ul",t._l(t.devList,(function(e){return a("li",{key:e.devId,class:e.active?"active":"",on:{click:function(a){return t.chooseDev(e)}}},[t._v(t._s(e.devName))])})),0)])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"!==t.major,expression:"major!=='VEHICLE'"}],staticClass:"attr"},[a("el-form",{ref:"selectForm",staticClass:"attr-form",attrs:{model:t.selectForm}},[a("el-form-item",{attrs:{label:"采集项:","label-width":"70px"}},[a("el-row",[a("el-checkbox",{on:{change:t.chooseVisibleAttr},model:{value:t.attrVisible,callback:function(e){t.attrVisible=e},expression:"attrVisible"}},[t._v("选中常用项")]),t._v(" "),a("el-button",{attrs:{size:"small"},on:{click:t.updateVisible}},[t._v("保存为常用项")])],1)],1)],1),t._v(" "),a("div",{staticClass:"attr-table"},[a("el-table",{ref:"attrList",staticStyle:{width:"100%",height:"100%",overflow:"auto"},attrs:{data:t.attrList,"tooltip-effect":"dark"},on:{"select-all":t.selectAllAttr,"selection-change":t.selectAttr}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),t._v(" "),a("el-table-column",{attrs:{prop:"RES_TYPE_NAME",label:"采集项"}}),t._v(" "),a("el-table-column",{attrs:{prop:"I_TYPE_NAME",label:"接口来源"}}),t._v(" "),a("el-table-column",{attrs:{prop:"visible",label:"常用",width:"45","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.visible?a("span",[t._v("是")]):a("span",[t._v("否")])]}}])})],1)],1)],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showTable,expression:"showTable"}],staticClass:"table-content"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"!==t.major,expression:"major!=='VEHICLE'"}],staticClass:"content-inner"},[a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.tableData}},t._l(t.headerData,(function(e,i){return a("el-table-column",{key:i,attrs:{label:e.RES_TYPE_NAME,prop:e.sort,align:"center",width:"150px"}},[e.SRC_NAME?[a("el-table-column",{attrs:{label:e.SRC_NAME,prop:e.sort,width:"150px"}})]:t._e()],2)})),1),t._v(" "),a("el-pagination",{staticStyle:{position:"absolute",bottom:"10px",right:"10px"},attrs:{background:"","current-page":t.pageInfo.currentPage,"page-size":t.pageInfo.pageSize,layout:"total, prev, pager, next, jumper",total:t.pageInfo.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"==t.major,expression:"major=='VEHICLE'"}],staticClass:"content-inner"},[a("el-table",{staticStyle:{width:"100%",margin:"20px 0 50px",height:"clac(100% - 70px)"},attrs:{data:t.carTableData}},[a("el-table-column",{attrs:{prop:"collectionName",label:"采集项"}}),t._v(" "),a("el-table-column",{attrs:{prop:"value",label:"采集值"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.value||e.row.value?a("span",[t._v(t._s(e.row.value))]):a("span",[t._v("无数据")])]}}])})],1),t._v(" "),a("el-pagination",{staticStyle:{position:"absolute",bottom:"10px",right:"10px"},attrs:{background:"","current-page":t.carPageInfo.currentPage,"page-size":t.carPageInfo.pageSize,"page-sizes":t.carPageInfo.pageSizes,layout:"total, prev, pager, next, jumper, sizes",total:t.carPageInfo.total},on:{"current-change":t.handleCarCurrentChange,"size-change":t.handleCarSizeChange}})],1)])])},s=[],n=a("a745"),r=a.n(n);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}function l(t){if(r()(t))return o(t)}var d=a("774e"),c=a.n(d),u=a("c8bb"),v=a.n(u),h=a("67bb"),f=a.n(h);function p(t){if("undefined"!==typeof f.a&&v()(Object(t)))return c()(t)}function g(t,e){if(t){if("string"===typeof t)return o(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?c()(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(t,e):void 0}}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(t){return l(t)||p(t)||g(t)||m()}a("55dd"),a("456d"),a("6b54"),a("ac6a");var y={name:"value",data:function(){return{formLoading:!0,loading:!1,major:null,showTable:!1,typeId:null,topCheck:!0,checkList:[],selectForm:{name:"",region:""},pageInfo:{currentPage:1,pageSize:10,total:0},carPageInfo:{currentPage:1,pageSize:10,pageSizes:[10,20,40,80,100],total:500},defaultHeader:[{RES_TYPE_NAME:"设备ID",SRC_NAME:"",sort:"devId"},{RES_TYPE_NAME:"设备名",SRC_NAME:"",sort:"devName"}],headerData:[{RES_TYPE_NAME:"设备ID",SRC_NAME:"",sort:"devId"},{RES_TYPE_NAME:"设备名",SRC_NAME:"",sort:"devName"}],tableData:[],carTableData:[],attrVisible:!1,devTypeList:[],devType:"",devName:"",carDev:null,devAllList:[],devList:[],tableDevList:[],lineList:[],stationList:[],trainList:[],trainCode:"",lineCode:"",stationCode:"",attrList:[],visibleAttrList:[]}},mounted:function(){this.getDevTypeList(),this.getLine(),this.getStation(),this.getTrain()},watch:{devName:function(t){this.devList=this.devAllList,this.devList=this.devAllList.filter((function(e){return-1!==e.devName.indexOf(t)}))}},methods:{refresh:function(){},getLine:function(){var t=this;this.$.ajax({url:"/devdata/linelist",type:"get",success:function(e){t.lineList=e.data}})},getStation:function(){var t=this;this.$.ajax({url:"/devdata/stationlist",type:"get",success:function(e){t.stationList=e.data}})},getTrain:function(){var t=this;this.$.ajax({url:"/devdata/trainlist",type:"get",success:function(e){t.trainList=e.data}})},getDevTypeList:function(){var t=this;this.$.ajax({url:"/devdata/listdevtype",type:"post",success:function(e){var a=e.data;a.forEach((function(t){t.devTypeId=t.devMainTypeId,t.devTypeName=t.devMainTypeName,t.children=t.sysDevTypeDefVoList}));var i=[{devTypeId:"SIG",devTypeName:"信号"},{devTypeId:"VEHICLE",devTypeName:"车辆"},{devTypeId:"BAS",devTypeName:"水泵"}];for(var s in a)for(var n in i)i[n].devTypeId===a[s].major&&(i[n].children=i[n].children?i[n].children:[],i[n].children.push(a[s]));t.formLoading=!1,t.devTypeList=[],t.devTypeList=i}})},chooseType:function(t){if(t&&0===t.length)return this.devId=null,this.devAllList=[],this.devList=[],this.attrList=[],void(this.tableData=[]);this.major=t[0],this.typeId=t[2],t[2]&&this.getDev()},getDev:function(){var t,e=this;if(this.major){if("VEHICLE"!==this.major&&this.stationCode)t=this.stationCode;else{if("VEHICLE"!=this.major||!this.trainCode)return e.devId=null,e.devAllList=[],e.devList=[],e.attrList=[],void(e.tableData=[]);t=this.trainCode}this.$.ajax({url:"/devdata/listdev",type:"post",data:{stationCode:t,typeid:e.typeId,start:0,limit:1e3},success:function(t){t.data&&t.data.records&&t.data.records.length>0?(e.devAllList=t.data.records,e.devList=t.data.records,"VEHICLE"!==e.major&&(e.pageInfo.total=t.data.total,e.devId=t.data.records[0].devId,e.getAttr(t.data.records[0].devId,t.data.records[0].devTypeId))):(e.devId=null,e.devAllList=[],e.devList=[],e.attrList=[],e.tableData=[])}})}},getDevPages:function(){var t=this;this.$.ajax({url:"/devdata/listdev",type:"post",data:{start:t.pageInfo.currentPage,limit:t.pageInfo.pageSize,typeid:t.typeId},success:function(e){t.tableDevList=e.data.records,t.getDevValue(t.tableDevList)}})},chooseDev:function(t){var e=this,a=t.devId,i=this.devList;i.forEach((function(i){if(a===i.devId&&1==i.active){if("VEHICLE"===e.major)return;i.active=!1,e.loading=!0,e.getDevValue(e.tableDevList)}else a===i.devId?"VEHICLE"===e.major?(i.active=!0,e.carDev=t,e.carPageInfo.pageSize=10,e.carPageInfo.currentPage=1,e.getCarAttrAndVal()):(e.loading=!0,e.getDevValue([t]),i.active=!0):i.active=!1})),this.devList=[],this.devList=i},getAttr:function(t,e){var a=this;this.$.ajax({url:"/devdata/listdevattr",type:"post",data:{devid:t},success:function(t){t.data.forEach((function(t,e){t.sort=e.toString()})),a.getVisibleAttr(t.data,e)}})},getCarAttrAndVal:function(){var t=this;this.$.ajax({url:"/devdata/getdevattr",type:"post",data:{major:t.major,devid:t.carDev.devId,start:t.carPageInfo.currentPage,limit:t.carPageInfo.pageSize},success:function(e){e.data&&e.data.length>0?(t.$.ajax({url:"/devdata/listcollections",type:"post",contentType:"application/json",data:JSON.stringify(e.data),dataType:"json",success:function(a){var i=e.data;i.forEach((function(t,e){Object.keys(a.data[e]).forEach((function(i){t.value=a.data[e][i]}))})),t.carTableData=[],t.carTableData=i}}),t.showTable=!0):this.$message({type:"warning",message:"无采集项信息"})}})},getVisibleAttr:function(t,e){var a=this;this.$.ajax({url:"/devdata/getvisible",type:"post",data:{typeid:e},success:function(e){e.data&&e.data.length>0&&(a.visibleAttrList=e.data,a.visibleAttrList.forEach((function(e){t.forEach((function(t){e.keyId==t.sort&&1==e.isVisible&&(t.id=e.id,t.visible=!0)}))}))),a.attrList=t,a.chooseAttrData=t,a.initAttrChoose(),a.initTableInfo(),a.headerData=[].concat(b(a.headerData),b(a.attrList)),a.showTable=!0}})},updateVisible:function(){var t=this,e=this.chooseAttrData,a=this;if(e&&e.length>0){this.loading=!0;var i=[];this.attrList.forEach((function(a){var s=0;e.forEach((function(t){a.sort==t.sort&&(s=1)})),i.push({id:a.id,typeId:t.typeId,isVisible:s,keyId:a.sort})})),this.$.ajax({type:"post",url:"/devdata/updatevisible",contentType:"application/json",data:JSON.stringify(i),dataType:"json",success:function(t){a.loading=!1,"0000"==t.code?(a.attrVisible=!1,a.getAttr(a.devId,a.typeId),a.$message({type:"success",message:"保存成功"})):a.$message({type:"warning",message:t.msg})}})}else this.$message({type:"warning",message:"请选择采集项"})},initAttrChoose:function(){var t=this;this.$nextTick((function(){for(var e=0;e<t.attrList.length;e++)t.$refs.attrList.toggleRowSelection(t.attrList[e],!0)}))},showVisible:function(){var t=this;this.$nextTick((function(){for(var e=0;e<t.attrList.length;e++)t.$refs.attrList.toggleRowSelection(t.attrList[e],t.attrList[e].visible)}))},chooseVisibleAttr:function(t){var e=this;this.attrVisible=t;var a=[],i=[];t?(this.showVisible(),this.visibleAttrList.forEach((function(t){1==t.isVisible&&e.attrList.forEach((function(e){t.keyId!=e.sort||i.push(e)}))})),a=[].concat(b(this.defaultHeader),i)):(this.initAttrChoose(),a=[].concat(b(this.defaultHeader),b(this.attrList))),this.headerData=[],this.headerData=a},selectAllAttr:function(t){t.sort((function(t,e){return t.sort>e.sort?1:t.sort<e.sort?-1:0})),this.chooseAttrData=t;var e=[].concat(b(this.defaultHeader),b(t));this.headerData=[],this.headerData=e},selectAttr:function(t){t.sort((function(t,e){return t.sort>e.sort?1:t.sort<e.sort?-1:0})),this.chooseAttrData=t;var e=[].concat(b(this.defaultHeader),b(t));this.headerData=[],this.headerData=e},initTableInfo:function(){this.pageInfo.total<=10?(this.tableDevList=this.devList,this.getDevValue(this.tableDevList)):this.getDevPages()},getDevValue:function(t){var e=[];t.forEach((function(t){e.push({devId:t.devId})}));var a=this;this.$.ajax({type:"post",url:"/devdata/listdevscollects",contentType:"application/json",data:JSON.stringify(e),dataType:"json",success:function(t){a.loading=!1,a.valData=t.data,a.valData&&a.drawVal(a.valData)}})},drawVal:function(t){var e=[];Object.keys(t).forEach((function(t){e.push({devId:t})})),this.devAllList.forEach((function(t){e.forEach((function(e){e.devId===t.devId&&(e.devName=t.devName)}))})),e.forEach((function(e,a){t[e.devId].forEach((function(t,a){e[a]=t||"无数据"}))})),this.tableData=[],this.tableData=e},handleCurrentChange:function(t){var e=this.devList;e.forEach((function(t){t.active=!1})),this.devList=[],this.devList=e,this.pageInfo.currentPage=t,this.getDevPages()},handleCarCurrentChange:function(t){this.carPageInfo.currentPage=t,this.getCarAttrAndVal()},handleCarSizeChange:function(t){this.carPageInfo.pageSize=t,this.getCarAttrAndVal()}}},L=y,I=(a("cafe"),a("2877")),C=Object(I["a"])(L,i,s,!1,null,"5fc39b1d",null);e["default"]=C.exports},"774e":function(t,e,a){t.exports=a("d2d5")},"7cd6":function(t,e,a){var i=a("40c3"),s=a("5168")("iterator"),n=a("481b");t.exports=a("584a").getIteratorMethod=function(t){if(void 0!=t)return t[s]||t["@@iterator"]||n[i(t)]}},"85f2":function(t,e,a){t.exports=a("454f")},"95d5":function(t,e,a){var i=a("40c3"),s=a("5168")("iterator"),n=a("481b");t.exports=a("584a").isIterable=function(t){var e=Object(t);return void 0!==e[s]||"@@iterator"in e||n.hasOwnProperty(i(e))}},a745:function(t,e,a){t.exports=a("f410")},ac6a:function(t,e,a){for(var i=a("cadf"),s=a("0d58"),n=a("2aba"),r=a("7726"),o=a("32e9"),l=a("84f2"),d=a("2b4c"),c=d("iterator"),u=d("toStringTag"),v=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=s(h),p=0;p<f.length;p++){var g,m=f[p],b=h[m],y=r[m],L=y&&y.prototype;if(L&&(L[c]||o(L,c,v),L[u]||o(L,u,m),l[m]=v,b))for(g in i)L[g]||n(L,g,i[g],!0)}},b0dc:function(t,e,a){var i=a("e4ae");t.exports=function(t,e,a,s){try{return s?e(i(a)[0],a[1]):e(a)}catch(r){var n=t["return"];throw void 0!==n&&i(n.call(t)),r}}},c8bb:function(t,e,a){t.exports=a("54a1")},cafe:function(t,e,a){"use strict";var i=a("4808"),s=a.n(i);s.a},d2d5:function(t,e,a){a("1654"),a("549b"),t.exports=a("584a").Array.from},d56d:function(t,e,a){"use strict";var i=a("603b"),s=a.n(i);s.a},f410:function(t,e,a){a("1af6"),t.exports=a("584a").Array.isArray}}]);