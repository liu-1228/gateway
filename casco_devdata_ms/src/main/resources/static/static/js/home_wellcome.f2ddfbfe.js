(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["home_wellcome"],{"02f4":function(e,t,a){var i=a("4588"),r=a("be13");e.exports=function(e){return function(t,a){var s,n,o=String(r(t)),l=i(a),c=o.length;return l<0||l>=c?e?"":void 0:(s=o.charCodeAt(l),s<55296||s>56319||l+1===c||(n=o.charCodeAt(l+1))<56320||n>57343?e?o.charAt(l):s:e?o.slice(l,l+2):n-56320+(s-55296<<10)+65536)}}},"0390":function(e,t,a){"use strict";var i=a("02f4")(!0);e.exports=function(e,t,a){return t+(a?i(e,t).length:1)}},"0a49":function(e,t,a){var i=a("9b43"),r=a("626a"),s=a("4bf8"),n=a("9def"),o=a("cd1c");e.exports=function(e,t){var a=1==e,l=2==e,c=3==e,d=4==e,u=6==e,h=5==e||u,v=t||o;return function(t,o,f){for(var p,g,m=s(t),b=r(m),y=i(o,f,3),L=n(b.length),I=0,C=a?v(t,L):l?v(t,0):void 0;L>I;I++)if((h||I in b)&&(p=b[I],g=y(p,I,m),e))if(a)C[I]=g;else if(g)switch(e){case 3:return!0;case 5:return p;case 6:return I;case 2:C.push(p)}else if(d)return!1;return u?-1:c||d?d:C}}},"0bfb":function(e,t,a){"use strict";var i=a("cb7c");e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},1169:function(e,t,a){var i=a("2d95");e.exports=Array.isArray||function(e){return"Array"==i(e)}},"11e9":function(e,t,a){var i=a("52a7"),r=a("4630"),s=a("6821"),n=a("6a99"),o=a("69a8"),l=a("c69a"),c=Object.getOwnPropertyDescriptor;t.f=a("9e1e")?c:function(e,t){if(e=s(e),t=n(t,!0),l)try{return c(e,t)}catch(a){}if(o(e,t))return r(!i.f.call(e,t),e[t])}},"1c16":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"selectItem"},[a("el-form",{ref:"selectForm",attrs:{"label-width":"80px"}},[a("el-form-item",{attrs:{label:"类型筛选"}},[a("el-cascader",{staticStyle:{width:"95%"},attrs:{options:e.devTypeList,props:{expandTrigger:"hover",value:"devTypeId",label:"devTypeName"},placeholder:"请选择设备类型",clearable:""},on:{change:e.chooseType},model:{value:e.devType,callback:function(t){e.devType=t},expression:"devType"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.major&&"VEHICLE"!==e.major,expression:"major && major!=='VEHICLE'"}],attrs:{label:"所属线路"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择所属线路"},on:{change:e.getDev},model:{value:e.lineCode,callback:function(t){e.lineCode=t},expression:"lineCode"}},e._l(e.lineList,(function(e){return a("el-option",{key:e.lineCode,attrs:{label:e.lineName,value:e.lineCode}})})),1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.major&&"VEHICLE"!==e.major,expression:"major && major!=='VEHICLE'"}],attrs:{label:"所属站点"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择所属站点"},on:{change:e.getDev},model:{value:e.stationCode,callback:function(t){e.stationCode=t},expression:"stationCode"}},e._l(e.stationList,(function(e){return a("el-option",{key:e.stationCode,attrs:{label:e.stationName,value:e.stationCode}})})),1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"==e.major,expression:"major=='VEHICLE'"}],attrs:{label:"所属车辆"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择所属车辆"},on:{change:e.getDev},model:{value:e.trainCode,callback:function(t){e.trainCode=t},expression:"trainCode"}},e._l(e.trainList,(function(e){return a("el-option",{key:e.trainId,attrs:{label:e.trainId,value:e.trainId}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"设备筛选"}},[a("el-input",{staticStyle:{width:"95%"},on:{change:e.getDev},model:{value:e.devName,callback:function(t){e.devName=t},expression:"devName"}})],1)],1),e._v(" "),a("div",{staticClass:"devList"},[a("ul",e._l(e.devList,(function(t){return a("li",{key:t.devId,class:t.active?"active":"",on:{click:function(a){return e.chooseDev(t)}}},[e._v(e._s(t.devName))])})),0)])],1),e._v(" "),a("div",{staticClass:"attr"},[a("div",{staticClass:"attr-table"},[a("el-table",{ref:"attrList",staticClass:"attr",staticStyle:{width:"100%",height:"100%"},attrs:{"highlight-current-row":"",data:e.attrList,"tooltip-effect":"dark"},on:{"selection-change":e.selectAttr}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{prop:"RES_TYPE_NAME",label:"采集项"}}),e._v(" "),a("el-table-column",{attrs:{prop:"SRC_NAME",label:"来源","show-overflow-tooltip":""}})],1)],1)])]),e._v(" "),a("div",{staticClass:"table-content"},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeTime},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),e.panels.length>0?a("iframe",{attrs:{id:"refresh_box",name:"refresh_name",title:"grafanaPanel",width:"100%"}}):e._e()])])},r=[],s=(a("28a5"),a("6b54"),a("ac6a"),{name:"charts",data:function(){return{dateRange:[],major:null,typeId:null,topCheck:!0,dbSrc:{SIG:"SIG",BAS:"BAS",VEHICLE:"TRAIN"},dbList:{SIG:{0:"SIG_DIGIT",1:"SIG_ANALOG",4:"SIG_ENUM"},BAS:{0:"BAS_DIGIT",1:"BAS_ANALOG"},VEHICLE:{0:"TRAIN_DIGIT",1:"TRAIN_ANALOG"}},lineList:[],stationList:[],trainList:[],trainCode:"",lineCode:"",stationCode:"",devTypeList:[],devType:"",devName:"",devAllList:[],devList:[],attrList:[],dashboard:[],panels:[],slug:"",uid:""}},mounted:function(){this.getLatestTime(),this.getLine(),this.getStation(),this.getTrain(),this.initDashboard(!0),this.getDevTypeList()},watch:{devName:function(e){this.devList=this.devAllList,this.devList=this.devAllList.filter((function(t){return-1!==t.devName.indexOf(e)}))}},methods:{getLatestTime:function(){this.dateRange[0]=new Date((new Date).getTime()-216e5),this.dateRange[1]=new Date},changeTime:function(e){var t=this;this.dateRange=e,this.$nextTick((function(){t.refreshIframeSrc()}))},getLine:function(){var e=this;this.$.ajax({url:"/api/devdata/linelist",type:"get",success:function(t){e.lineList=t.data}})},getStation:function(){var e=this;this.$.ajax({url:"/api/devdata/stationlist",type:"get",success:function(t){e.stationList=t.data}})},getTrain:function(){var e=this;this.$.ajax({url:"/api/devdata/trainlist",type:"get",success:function(t){e.trainList=t.data}})},initDashboard:function(e){var t=this;this.$.ajax({url:"/grafana/api/dashboards/db/curve",type:"get",success:function(a){var i=a.dashboard;i.panels=[],t.updateDashboard(i,e)}})},updateDashboard:function(e,t){var a={dashboard:e,message:"reset",overwrite:!1},i=this;this.$.ajax({url:"/grafana/api/dashboards/db",type:"post",contentType:"application/json",data:JSON.stringify(a),success:function(e){i.getDashboard(t)}})},getDashboard:function(e){var t=this;this.$.ajax({url:"/grafana/api/dashboards/db/curve",type:"get",success:function(a){t.dashboard=a.dashboard,t.slug=a.dashboard.title,t.uid=a.dashboard.uid,t.panels=a.dashboard.panels,!e&&t.uid&&t.$nextTick((function(){t.refreshIframeSrc()}))}})},getDevTypeList:function(){var e=this;this.$.ajax({url:"/api/devdata/listdevtype",type:"post",success:function(t){var a=t.data;a.forEach((function(e){e.devTypeId=e.devMainTypeId,e.devTypeName=e.devMainTypeName,e.children=e.sysDevTypeDefVoList}));var i=[{devTypeId:"SIG",devTypeName:"信号"},{devTypeId:"VEHICLE",devTypeName:"车辆"},{devTypeId:"BAS",devTypeName:"水泵"}];for(var r in a)for(var s in i)i[s].devTypeId===a[r].major&&(i[s].children=i[s].children?i[s].children:[],i[s].children.push(a[r]));e.devTypeList=[],e.devTypeList=i}})},chooseType:function(e){if(e&&0===e.length)return this.devAllList=[],this.devList=[],this.attrList=[],void(this.tableData=[]);this.major=e[0],this.typeId=e[2],e[2]&&this.getDev()},getDev:function(e){var t,a=this;if(this.major){if("VEHICLE"!==this.major&&this.stationCode)t=this.stationCode;else{if("VEHICLE"!=this.major||!this.trainCode)return a.devAllList=[],a.devList=[],a.attrList=[],void(a.tableData=[]);t=this.trainCode}this.$.ajax({url:"/api/devdata/listdev",type:"post",data:{stationCode:t,typeid:a.typeId,start:0,limit:1e3},success:function(e){e.data&&e.data.records&&e.data.records.length>0?(a.devAllList=e.data.records,a.devList=e.data.records,a.attrList=[]):(a.devAllList=[],a.devList=[],a.attrList=[])}})}},chooseDev:function(e){var t=e.devId,a=this.devList;a.forEach((function(e){t===e.devId&&1==e.active?e.active=!1:t===e.devId?e.active=!0:e.active=!1})),this.devList=[],this.devList=a,this.getAttr(e.devId)},getAttr:function(e){var t=this;this.$.ajax({url:"/api/devdata/listdevattr",type:"post",data:{devid:e},success:function(e){e.data.forEach((function(e,t){e.sort=t.toString()})),t.attrList=e.data}})},selectAttr:function(e){var t=this,i=this,r=i.dashboard;r.panels=[];var s=a("2ffb").default;e.forEach((function(e,a){var n=s;n.id=a,n.gridPos.y=6*a,n.datasource=t.dbSrc[t.major],n.title=e.RES_TYPE_NAME,n.targets[0].measurement=i.dbList[i.major][e.DATA_TYPE],n.targets[0].alias="val",n.targets[0].tags=[];var o=e.KEY_ID.split(".");"VEHICLE"!=i.major?(n.targets[0].tags.push({key:"line",operator:"=",value:o[1]}),n.targets[0].tags.push({key:"region",operator:"=",value:o[2]}),n.targets[0].tags.push({key:"srcId",operator:"=",value:o[3]}),n.targets[0].tags.push({key:"type",operator:"=",value:o[4]}),n.targets[0].tags.push({key:"pointcode",operator:"=",value:o[5]})):(n.targets[0].tags.push({key:"line",operator:"=",value:o[1]}),n.targets[0].tags.push({key:"region",operator:"=",value:o[2]}),n.targets[0].tags.push({key:"pointcode",operator:"=",value:o[3]})),r.panels.push(JSON.parse(JSON.stringify(n)))})),this.updateDashboard(r)},refreshIframeSrc:function(){var e="http://10.153.102.3:3000/casco/"+this.uid+"/"+this.slug+"?from="+this.dateRange[0].getTime()+"&to="+this.dateRange[1].getTime();document.getElementById("refresh_box").src=e}}}),n=s,o=(a("e050"),a("2877")),l=Object(o["a"])(n,i,r,!1,null,"ecbe0262",null);t["default"]=l.exports},"20d6":function(e,t,a){"use strict";var i=a("5ca1"),r=a("0a49")(6),s="findIndex",n=!0;s in[]&&Array(1)[s]((function(){n=!1})),i(i.P+i.F*n,"Array",{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(s)},"214f":function(e,t,a){"use strict";a("b0c5");var i=a("2aba"),r=a("32e9"),s=a("79e5"),n=a("be13"),o=a("2b4c"),l=a("520a"),c=o("species"),d=!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2===a.length&&"a"===a[0]&&"b"===a[1]}();e.exports=function(e,t,a){var h=o(e),v=!s((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),f=v?!s((function(){var t=!1,a=/a/;return a.exec=function(){return t=!0,null},"split"===e&&(a.constructor={},a.constructor[c]=function(){return a}),a[h](""),!t})):void 0;if(!v||!f||"replace"===e&&!d||"split"===e&&!u){var p=/./[h],g=a(n,h,""[e],(function(e,t,a,i,r){return t.exec===l?v&&!r?{done:!0,value:p.call(t,a,i)}:{done:!0,value:e.call(a,t,i)}:{done:!1}})),m=g[0],b=g[1];i(String.prototype,e,m),r(RegExp.prototype,h,2==t?function(e,t){return b.call(e,this,t)}:function(e){return b.call(e,this)})}}},"28a5":function(e,t,a){"use strict";var i=a("aae3"),r=a("cb7c"),s=a("ebd6"),n=a("0390"),o=a("9def"),l=a("5f1b"),c=a("520a"),d=a("79e5"),u=Math.min,h=[].push,v="split",f="length",p="lastIndex",g=4294967295,m=!d((function(){RegExp(g,"y")}));a("214f")("split",2,(function(e,t,a,d){var b;return b="c"=="abbc"[v](/(b)*/)[1]||4!="test"[v](/(?:)/,-1)[f]||2!="ab"[v](/(?:ab)*/)[f]||4!="."[v](/(.?)(.?)/)[f]||"."[v](/()()/)[f]>1||""[v](/.?/)[f]?function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!i(e))return a.call(r,e,t);var s,n,o,l=[],d=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,v=void 0===t?g:t>>>0,m=new RegExp(e.source,d+"g");while(s=c.call(m,r)){if(n=m[p],n>u&&(l.push(r.slice(u,s.index)),s[f]>1&&s.index<r[f]&&h.apply(l,s.slice(1)),o=s[0][f],u=n,l[f]>=v))break;m[p]===s.index&&m[p]++}return u===r[f]?!o&&m.test("")||l.push(""):l.push(r.slice(u)),l[f]>v?l.slice(0,v):l}:"0"[v](void 0,0)[f]?function(e,t){return void 0===e&&0===t?[]:a.call(this,e,t)}:a,[function(a,i){var r=e(this),s=void 0==a?void 0:a[t];return void 0!==s?s.call(a,r,i):b.call(String(r),a,i)},function(e,t){var i=d(b,e,this,t,b!==a);if(i.done)return i.value;var c=r(e),h=String(this),v=s(c,RegExp),f=c.unicode,p=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(m?"y":"g"),y=new v(m?c:"^(?:"+c.source+")",p),L=void 0===t?g:t>>>0;if(0===L)return[];if(0===h.length)return null===l(y,h)?[h]:[];var I=0,C=0,x=[];while(C<h.length){y.lastIndex=m?C:0;var E,T=l(y,m?h:h.slice(C));if(null===T||(E=u(o(y.lastIndex+(m?0:C)),h.length))===I)C=n(h,C,f);else{if(x.push(h.slice(I,C)),x.length===L)return x;for(var _=1;_<=T.length-1;_++)if(x.push(T[_]),x.length===L)return x;C=I=E}}return x.push(h.slice(I)),x}]}))},"2f21":function(e,t,a){"use strict";var i=a("79e5");e.exports=function(e,t){return!!e&&i((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},"2ffb":function(e,t,a){"use strict";a.r(t),t["default"]={aliasColors:{},bars:!1,dashLength:10,dashes:!1,datasource:"",fill:1,fillGradient:0,gridPos:{h:6,w:24,x:0,y:0},hiddenSeries:!1,id:2,legend:{avg:!1,current:!1,max:!1,min:!1,show:!0,total:!1,values:!1},lines:!0,linewidth:1,nullPointMode:"null",options:{dataLinks:[]},percentage:!1,pointradius:2,points:!1,renderer:"flot",seriesOverrides:[],spaceLength:10,stack:!1,steppedLine:!0,targets:[{groupBy:[],measurement:"win_cpu",orderByTime:"ASC",policy:"default",refId:"A",resultFormat:"time_series",select:[[{params:["value"],type:"field"}]],tags:[{key:"instance",operator:"=",value:"_Total"}]}],thresholds:[],timeFrom:null,timeRegions:[],timeShift:null,title:"test",tooltip:{shared:!0,sort:0,value_type:"individual"},type:"graph",xaxis:{buckets:null,mode:"time",name:null,show:!0,values:[]},yaxes:[{format:"short",label:null,logBase:1,max:null,min:null,show:!0},{format:"short",label:null,logBase:1,max:null,min:null,show:!0}],yaxis:{align:!1,alignLevel:null}}},3846:function(e,t,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"3ac5":function(e,t,a){"use strict";var i=a("cce0"),r=a.n(i);r.a},"40c3":function(e,t,a){"use strict";a.r(t);var i,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"selectItem"},[a("el-form",{attrs:{"label-width":"50px"}},[a("el-form-item",{attrs:{label:"线路"}},[a("el-select",{staticStyle:{width:"95%"},model:{value:e.lineCode,callback:function(t){e.lineCode=t},expression:"lineCode"}},e._l(e.lineList,(function(e){return a("el-option",{key:e.lineCode,attrs:{label:e.lineName,value:e.lineCode}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车辆"}},[a("el-select",{staticStyle:{width:"95%"},model:{value:e.trainCode,callback:function(t){e.trainCode=t},expression:"trainCode"}},e._l(e.trainList,(function(e){return a("el-option",{key:e.trainId,attrs:{label:e.trainName,value:e.trainId}})})),1)],1)],1)],1),e._v(" "),a("div",{staticClass:"attr"},[a("p",[e._v("分析数据")]),e._v(" "),a("div",{staticClass:"attr-table"},[e.summary_set.length>0?a("el-tree",{ref:"attrTree",attrs:{data:e.summary_set,prop:e.setProps,"node-key":"id","show-checkbox":""},on:{"check-change":e.handleCheckChange}}):e._e()],1)])]),e._v(" "),a("div",{staticClass:"table-content"},[a("el-form",{staticClass:"search-form",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{staticClass:"scene",attrs:{label:"分析场景"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择分析场景"},on:{change:e.chooseScene},model:{value:e.formInline.scene,callback:function(t){e.$set(e.formInline,"scene",t)},expression:"formInline.scene"}},e._l(e.sceneList,(function(e){return a("el-option",{key:e.scene_id,attrs:{value:e.scene_id,label:e.scene_name}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"date-time"},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeTime},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),a("el-form-item",{staticClass:"alarm-choose",attrs:{label:"历史报警中选择"}},[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"选择报警"},on:{change:e.chooseAlarm},model:{value:e.formInline.alarm,callback:function(t){e.$set(e.formInline,"alarm",t)},expression:"formInline.alarm"}},e._l(e.alarmList,(function(e,t){return a("el-option",{key:t,attrs:{value:t,label:e.name}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"search"},[a("el-button",{attrs:{type:"primary"},on:{click:e.drawDashboard}},[e._v("查询")])],1)],1),e._v(" "),e.dateRange[0]?a("div",{staticClass:"bottom"},[a("div",{staticClass:"b-left"},[e.scene?a("iframe",{attrs:{id:"refresh_box",name:"refresh_name",src:"http://10.153.102.3:3000/casco/"+e.uid+"/"+e.slug+"?from="+e.dateRange[0].getTime()+"&to="+e.dateRange[1].getTime(),title:"grafanaPanel",width:"100%"}}):e._e()]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.alarmContent,expression:"alarmContent"}],staticClass:"b-right"},[e.alarmImg?a("img",{staticStyle:{padding:"20px"},attrs:{src:e.baseUrl+e.alarmImg,width:"460"}}):e._e(),e._v(" "),e.alarmContent?a("p",[e._v("分析结论: "+e._s(e.alarmContent))]):e._e()])]):e._e()],1)])},s=[],n=a("bd86"),o=(a("20d6"),a("28a5"),a("ac6a"),{name:"charts",data:function(){return{baseUrl:"http://10.153.102.3:7003",dateRange:[],major:null,showTable:!1,typeId:null,topCheck:!0,formInline:{scene:"",alarm:""},setProps:{label:"name"},attr:[{uid:"",slug:""}],VEHICLE:{0:"TRAIN_DIGIT",1:"TRAIN_ANALOG"},lineList:[{lineCode:"9",lineName:"9号线"}],stationList:[],trainList:[{trainId:"9",trainName:"T9"}],trainCode:"9",lineCode:"9",dashboard:[],panels:[],slug:"",uid:"",sceneList:[],scene:null,summary_set:[],alarmList:[],alarmImgs:[],alarmImg:null,alarmContent:null,checkedAttr:[]}},mounted:function(){this.initDashboard(),this.getSceneList()},watch:{devName:function(e){this.devList=this.devAllList,this.devList=this.devAllList.filter((function(t){return-1!==t.devName.indexOf(e)}))}},methods:(i={initDashboard:function(){var e=this;this.$.ajax({url:"/grafana/api/dashboards/db/slip",type:"get",success:function(t){var a=t.dashboard;a.panels=[],e.updateDashboard(a)}})},updateDashboard:function(e){var t={dashboard:e,message:"reset",overwrite:!1},a=this;this.$.ajax({url:"/grafana/api/dashboards/db",type:"post",contentType:"application/json",data:JSON.stringify(t),success:function(e){a.getDashboard()}})},getDashboard:function(){var e=this;this.$.ajax({url:"/grafana/api/dashboards/db/slip",type:"get",success:function(t){e.dashboard=t.dashboard,e.slug=t.dashboard.title,e.uid=t.dashboard.uid,e.panels=t.dashboard.panels,window.open(document.getElementById("refresh_box").src,"refresh_name","")}})},getSceneList:function(){var e=this;this.$.ajax({url:"/slip/siganalysis/listscene",type:"post",success:function(t){e.sceneList=t.data}})},chooseScene:function(e){var t=this;this.sceneList.forEach((function(a){e===a.scene_id&&(t.checkedAttr=[],t.scene=a,t.initSummarySet(),t.getAlarm(a.arm_code_set),t.getAlarmImgs(a.scene_id))}))},getAlarmImgs:function(e){var t=this;this.$.ajax({url:"/slip/siganalysis/listimages?sceneId="+e,type:"post",success:function(e){t.alarmImgs=e.data}})},initSummarySet:function(){var e=this,t=this;this.summary_set=[];var a=this.scene.summary_set;a.forEach((function(e,a){t.summary_set.push({id:e.split("#")[0],label:e.split("#")[3]+"#"+e.split("#")[1],dataType:e.split("#")[2]})}));var i=[];i.push(this.scene.summary_set[0].split("#")[0]),i.push(this.scene.summary_set[1].split("#")[0]),i.push(this.scene.summary_set[2].split("#")[0]),this.$nextTick((function(){e.$refs.attrTree.setCheckedKeys(i)}))},chooseAlarm:function(e){var t=this;this.alarmContent=t.alarmList[e].armContent,this.alarmImgs.forEach((function(a){a.armCode===t.alarmList[e].armCode&&(t.alarmImg=a.armImagePath,t.refreshAlarmTime(t.alarmList[e].armHappenTime))}))},refreshAlarmTime:function(e){var t=[new Date(new Date(e).getTime()-3e5),new Date(new Date(e).getTime()+3e5)];this.dateRange=[],this.dateRange=t},getAlarm:function(e){var t=e.split(","),a=this;this.$.ajax({url:"/slip/siganalysis/listalarm",type:"post",contentType:"application/json",data:JSON.stringify({alarmCode:t,start:"2020-05-05 00:00:00",end:"2021-05-05 23:59:59"}),dataType:"json",success:function(e){a.alarmList=e.data,a.alarmList.forEach((function(e){e.name=e.armContent+a.formatLongDate(new Date(e.armHappenTime))}))}})},formatLongDate:function(e){var t=e.getFullYear(),a=e.getMonth()+1,i=e.getDate(),r=e.getHours(),s=e.getMinutes(),n=e.getSeconds();return a<10&&(a="0"+a),i<10&&(i="0"+i),r<10&&(r="0"+r),s<10&&(s="0"+s),n<10&&(n="0"+n),t+"-"+a+"-"+i+" "+r+":"+s+":"+n},handleCheckChange:function(e,t,a){console.log(111),t?this.checkedAttr.push(e):this.checkedAttr.splice(this.checkedAttr.findIndex((function(t){return t.id===e.id})),1),this.formInline.alarm||this.getLatestTime(),this.drawDashboard()},drawDashboard:function(){var e=this.checkedAttr,t=this,i=t.dashboard;i.panels=[];var r=a("534a").default;e.forEach((function(e,a){var s=r;s.id=a,s.gridPos.y=6*a,s.datasource="TRAIN",s.title=e.label,s.targets[0].measurement=t.VEHICLE[e.dataType],s.targets[0].alias="val",s.targets[0].tags[0].key="pointcode";var n=e.id.split(".");s.targets[0].tags[0].value=n[2]+"_"+n[3],i.panels.push(JSON.parse(JSON.stringify(s)))})),this.updateDashboard(i),this.showTable=!0},getLatestTime:function(){var e=[new Date((new Date).getTime()-216e5),new Date];this.dateRange=[],this.dateRange=e},changeTime:function(e){this.dateRange=e}},Object(n["a"])(i,"initDashboard",(function(){var e=this;this.$.ajax({url:"/grafana/api/dashboards/db/slip",type:"get",success:function(t){var a=t.dashboard;a.panels=[],e.updateDashboard(a)}})})),Object(n["a"])(i,"updateDashboard",(function(e){var t=this,a={dashboard:e,message:"reset",overwrite:!1},i=this;setTimeout((function(){t.$.ajax({url:"/grafana/api/dashboards/db",type:"post",contentType:"application/json",data:JSON.stringify(a),success:function(e){i.getDashboard()}})}),1e3)})),Object(n["a"])(i,"getDashboard",(function(){var e=this;this.$.ajax({url:"/grafana/api/dashboards/db/slip",type:"get",success:function(t){e.dashboard=t.dashboard,e.slug=t.dashboard.title,e.uid=t.dashboard.uid,e.panels=t.dashboard.panels,e.uid&&window.open(document.getElementById("refresh_box").src,"refresh_name","")}})})),i)}),l=o,c=(a("3ac5"),a("2877")),d=Object(c["a"])(l,r,s,!1,null,"046eefef",null);t["default"]=d.exports},"454f":function(e,t,a){a("46a7");var i=a("584a").Object;e.exports=function(e,t,a){return i.defineProperty(e,t,a)}},"456d":function(e,t,a){var i=a("4bf8"),r=a("0d58");a("5eda")("keys",(function(){return function(e){return r(i(e))}}))},"46a7":function(e,t,a){var i=a("63b6");i(i.S+i.F*!a("8e60"),"Object",{defineProperty:a("d9f6").f})},"520a":function(e,t,a){"use strict";var i=a("0bfb"),r=RegExp.prototype.exec,s=String.prototype.replace,n=r,o="lastIndex",l=function(){var e=/a/,t=/b*/g;return r.call(e,"a"),r.call(t,"a"),0!==e[o]||0!==t[o]}(),c=void 0!==/()??/.exec("")[1],d=l||c;d&&(n=function(e){var t,a,n,d,u=this;return c&&(a=new RegExp("^"+u.source+"$(?!\\s)",i.call(u))),l&&(t=u[o]),n=r.call(u,e),l&&n&&(u[o]=u.global?n.index+n[0].length:t),c&&n&&n.length>1&&s.call(n[0],a,(function(){for(d=1;d<arguments.length-2;d++)void 0===arguments[d]&&(n[d]=void 0)})),n}),e.exports=n},"534a":function(e,t,a){"use strict";a.r(t);var i,r=a("bd86");t["default"]=(i={aliasColors:{},bars:!1,dashLength:10,dashes:!1,datasource:"",fill:1,fillGradient:0,gridPos:{h:6,w:24,x:0,y:0},legend:{avg:!1,current:!1,max:!1,min:!1,show:!1,total:!1,values:!1},hiddenSeries:!1,id:2},Object(r["a"])(i,"legend",{avg:!1,current:!1,max:!1,min:!1,show:!0,total:!1,values:!1}),Object(r["a"])(i,"lines",!0),Object(r["a"])(i,"linewidth",1),Object(r["a"])(i,"nullPointMode","null"),Object(r["a"])(i,"options",{dataLinks:[]}),Object(r["a"])(i,"percentage",!1),Object(r["a"])(i,"pointradius",2),Object(r["a"])(i,"points",!1),Object(r["a"])(i,"renderer","flot"),Object(r["a"])(i,"seriesOverrides",[]),Object(r["a"])(i,"spaceLength",10),Object(r["a"])(i,"stack",!1),Object(r["a"])(i,"steppedLine",!0),Object(r["a"])(i,"targets",[{groupBy:[],measurement:"win_cpu",orderByTime:"ASC",policy:"default",refId:"A",resultFormat:"time_series",select:[[{params:["value"],type:"field"}]],tags:[{key:"instance",operator:"=",value:"_Total"}]}]),Object(r["a"])(i,"thresholds",[]),Object(r["a"])(i,"timeFrom",null),Object(r["a"])(i,"timeRegions",[]),Object(r["a"])(i,"timeShift",null),Object(r["a"])(i,"title","test"),Object(r["a"])(i,"tooltip",{shared:!0,sort:0,value_type:"individual"}),Object(r["a"])(i,"type","graph"),Object(r["a"])(i,"xaxis",{buckets:null,mode:"time",name:null,show:!0,values:[]}),Object(r["a"])(i,"yaxes",[{format:"short",label:null,logBase:1,max:null,min:null,show:!0},{format:"short",label:null,logBase:1,max:null,min:null,show:!0}]),Object(r["a"])(i,"yaxis",{align:!1,alignLevel:null}),i)},"549f":function(e,t,a){"use strict";var i=a("5ded"),r=a.n(i);r.a},"55dd":function(e,t,a){"use strict";var i=a("5ca1"),r=a("d8e8"),s=a("4bf8"),n=a("79e5"),o=[].sort,l=[1,2,3];i(i.P+i.F*(n((function(){l.sort(void 0)}))||!n((function(){l.sort(null)}))||!a("2f21")(o)),"Array",{sort:function(e){return void 0===e?o.call(s(this)):o.call(s(this),r(e))}})},"5dbc":function(e,t,a){var i=a("d3f4"),r=a("8b97").set;e.exports=function(e,t,a){var s,n=t.constructor;return n!==a&&"function"==typeof n&&(s=n.prototype)!==a.prototype&&i(s)&&r&&r(e,s),e}},"5ded":function(e,t,a){},"5eda":function(e,t,a){var i=a("5ca1"),r=a("8378"),s=a("79e5");e.exports=function(e,t){var a=(r.Object||{})[e]||Object[e],n={};n[e]=t(a),i(i.S+i.F*s((function(){a(1)})),"Object",n)}},"5f1b":function(e,t,a){"use strict";var i=a("23c6"),r=RegExp.prototype.exec;e.exports=function(e,t){var a=e.exec;if("function"===typeof a){var s=a.call(e,t);if("object"!==typeof s)throw new TypeError("RegExp exec method returned something other than an Object or null");return s}if("RegExp"!==i(e))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(e,t)}},"6b54":function(e,t,a){"use strict";a("3846");var i=a("cb7c"),r=a("0bfb"),s=a("9e1e"),n="toString",o=/./[n],l=function(e){a("2aba")(RegExp.prototype,n,e,!0)};a("79e5")((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?l((function(){var e=i(this);return"/".concat(e.source,"/","flags"in e?e.flags:!s&&e instanceof RegExp?r.call(e):void 0)})):o.name!=n&&l((function(){return o.call(this)}))},"76b1":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"content"},[a("div",{staticClass:"left"},[a("div",{staticClass:"selectItem"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.formLoading,expression:"formLoading"}],ref:"selectForm",attrs:{model:e.selectForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"类型筛选"}},[a("el-cascader",{staticStyle:{width:"95%"},attrs:{options:e.devTypeList,props:{expandTrigger:"hover",value:"devTypeId",label:"devTypeName"},placeholder:"请选择设备类型",clearable:""},on:{change:e.chooseType},model:{value:e.devType,callback:function(t){e.devType=t},expression:"devType"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.major&&"VEHICLE"!==e.major,expression:"major && major!=='VEHICLE'"}],attrs:{label:"所属线路"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择所属线路"},on:{change:e.getDev},model:{value:e.lineCode,callback:function(t){e.lineCode=t},expression:"lineCode"}},e._l(e.lineList,(function(e){return a("el-option",{key:e.lineCode,attrs:{label:e.lineName,value:e.lineCode}})})),1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.major&&"VEHICLE"!==e.major,expression:"major && major!=='VEHICLE'"}],attrs:{label:"所属站点"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择所属站点"},on:{change:e.getDev},model:{value:e.stationCode,callback:function(t){e.stationCode=t},expression:"stationCode"}},e._l(e.stationList,(function(e){return a("el-option",{key:e.stationCode,attrs:{label:e.stationName,value:e.stationCode}})})),1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"==e.major,expression:"major=='VEHICLE'"}],attrs:{label:"所属车辆"}},[a("el-select",{staticStyle:{width:"95%"},attrs:{placeholder:"请选择所属车辆"},on:{change:e.getDev},model:{value:e.trainCode,callback:function(t){e.trainCode=t},expression:"trainCode"}},e._l(e.trainList,(function(e){return a("el-option",{key:e.trainId,attrs:{label:e.trainId,value:e.trainId}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"设备筛选"}},[a("el-input",{staticStyle:{width:"95%"},on:{change:e.getDev},model:{value:e.devName,callback:function(t){e.devName=t},expression:"devName"}})],1)],1),e._v(" "),a("div",{staticClass:"devList"},[a("ul",e._l(e.devList,(function(t){return a("li",{key:t.devId,class:t.active?"active":"",on:{click:function(a){return e.chooseDev(t)}}},[e._v(e._s(t.devName))])})),0)])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"!==e.major&&!e.vertical,expression:"major!=='VEHICLE' && !vertical"}],staticClass:"attr"},[a("el-form",{ref:"selectForm",staticClass:"attr-form",attrs:{model:e.selectForm}},[a("el-form-item",{attrs:{label:"采集项:","label-width":"70px"}},[a("el-row",[a("el-checkbox",{on:{change:e.chooseVisibleAttr},model:{value:e.attrVisible,callback:function(t){e.attrVisible=t},expression:"attrVisible"}},[e._v("选中常用项")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.updateVisible}},[e._v("保存为常用项")])],1)],1)],1),e._v(" "),a("div",{staticClass:"attr-table"},[a("el-table",{ref:"attrList",staticClass:"attr",staticStyle:{width:"100%",height:"100%"},attrs:{data:e.attrList,"tooltip-effect":"dark"},on:{"select-all":e.selectAllAttr,"selection-change":e.selectAttr}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{prop:"RES_TYPE_NAME",label:"采集项"}}),e._v(" "),a("el-table-column",{attrs:{prop:"I_TYPE_NAME",label:"接口来源"}}),e._v(" "),a("el-table-column",{attrs:{prop:"visible",label:"常用",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.visible?a("span",[e._v("是")]):a("span",[e._v("否")])]}}])})],1)],1)],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showTable,expression:"showTable"}],staticClass:"table-content"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"!==e.major&&!e.vertical,expression:"major!=='VEHICLE' && !vertical"}],staticClass:"content-inner"},[a("el-table",{staticStyle:{width:"100%","margin-top":"15px"},attrs:{data:e.tableData}},e._l(e.headerData,(function(t,i){return a("el-table-column",{key:i,attrs:{"render-header":function(a,i){return e.renderHeader(a,i,t.grey)},order:t.RES_TYPE_NAME,label:t.RES_TYPE_NAME,prop:t.sort,align:"center",width:"150px"}},[t.SRC_NAME?[a("el-table-column",{attrs:{label:t.SRC_NAME,prop:t.sort,"render-header":function(a,i){return e.renderHeader(a,i,t.grey)},order:t.RES_TYPE_NAME,width:"150px"}},[a("el-table-column",{attrs:{"render-header":function(a,i){return e.renderHeader(a,i,t.grey)},order:t.RES_TYPE_NAME,label:t.I_TYPE_NAME,prop:t.sort,width:"150px"}})],1)]:e._e()],2)})),1),e._v(" "),a("el-pagination",{staticStyle:{position:"absolute",bottom:"10px",right:"10px"},attrs:{background:"","current-page":e.pageInfo.currentPage,"page-size":e.pageInfo.pageSize,layout:"total, prev, pager, next, jumper",total:e.pageInfo.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"VEHICLE"==e.major||e.vertical,expression:"major=='VEHICLE' || vertical"}],staticClass:"content-inner"},[a("el-table",{staticStyle:{width:"100%","padding-top":"15px",height:"calc(100% - 50px)"},attrs:{data:e.carTableData}},[a("el-table-column",{attrs:{prop:"collectionName",label:"采集项"}}),e._v(" "),a("el-table-column",{attrs:{prop:"value",label:"采集值"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.value||t.row.value?a("span",[e._v(e._s(t.row.value))]):a("span",[e._v("无数据")])]}}])})],1),e._v(" "),a("el-pagination",{staticStyle:{position:"absolute",bottom:"10px",right:"10px"},attrs:{background:"","current-page":e.carPageInfo.currentPage,"page-size":e.carPageInfo.pageSize,"page-sizes":e.carPageInfo.pageSizes,layout:"total, prev, pager, next, jumper, sizes",total:e.carPageInfo.total},on:{"current-change":e.handleCarCurrentChange,"size-change":e.handleCarSizeChange}})],1)])])},r=[],s=(a("28a5"),a("c5f6"),a("55dd"),a("456d"),a("6b54"),a("ac6a"),{name:"value",data:function(){return{formLoading:!0,loading:!1,major:null,showTable:!1,typeId:null,topCheck:!0,checkList:[],selectForm:{name:"",region:""},pageInfo:{currentPage:1,pageSize:10,total:0},carPageInfo:{currentPage:1,pageSize:20,pageSizes:[10,20,40,80,100],total:0},defaultHeader:[{RES_TYPE_NAME:"设备ID",SRC_NAME:"",sort:"devId"},{RES_TYPE_NAME:"设备名",SRC_NAME:"",sort:"devName"}],headerData:[],tableData:[],carTableData:[],attrVisible:!1,devTypeList:[],devType:"",devName:"",carDev:null,devAllList:[],devList:[],tableDevList:[],lineList:[],stationList:[],trainList:[],trainCode:"",lineCode:"",stationCode:"",attrList:[],visibleAttrList:[],currentDev:[],refresh:null,carRefresh:null,vertical:!1,verList:[]}},mounted:function(){this.getDevTypeList(),this.getLine(),this.getStation(),this.getTrain(),this.getVerticalDevType()},watch:{devName:function(e){this.devList=this.devAllList,this.devList=this.devAllList.filter((function(t){return-1!==t.devName.indexOf(e)}))}},methods:{renderHeader:function(e,t,a){var i=t.column;t.$index;return e("div",[e("span",{domProps:{innerHTML:i.label},style:a?"color: #666;":"color: #FFF;"})])},refreshData:function(){var e=this;clearInterval(this.refresh),this.refresh=setInterval((function(){e.getDevValue(e.currentDev)}),2e4)},refreshCarData:function(){var e=this;clearInterval(this.carRefresh),this.carRefresh=setInterval((function(){e.getCarAttrAndVal()}),2e4)},getVerticalDevType:function(){var e=this;this.$.ajax({url:"/api/devdata/vertical/devtype",type:"get",success:function(t){t.data&&t.data.length>=0&&t.data.forEach((function(t){e.verList.push(t.devTypeId)}))}})},getLine:function(){var e=this;this.$.ajax({url:"/api/devdata/linelist",type:"get",success:function(t){e.lineList=t.data}})},getStation:function(){var e=this;this.$.ajax({url:"/api/devdata/stationlist",type:"get",success:function(t){e.stationList=t.data}})},getTrain:function(){var e=this;this.$.ajax({url:"/api/devdata/trainlist",type:"get",success:function(t){e.trainList=t.data}})},getDevTypeList:function(){var e=this;this.$.ajax({url:"/api/devdata/listdevtype",type:"post",success:function(t){var a=t.data;a.forEach((function(e){e.devTypeId=e.devMainTypeId,e.devTypeName=e.devMainTypeName,e.children=e.sysDevTypeDefVoList}));var i=[{devTypeId:"SIG",devTypeName:"信号"},{devTypeId:"VEHICLE",devTypeName:"车辆"},{devTypeId:"BAS",devTypeName:"水泵"}];for(var r in a)for(var s in i)i[s].devTypeId===a[r].major&&(i[s].children=i[s].children?i[s].children:[],i[s].children.push(a[r]));e.formLoading=!1,e.devTypeList=[],e.devTypeList=i}})},chooseType:function(e){if(clearInterval(this.refresh),clearInterval(this.carRefresh),this.carTableData=[],this.carPageInfo.total=0,e&&0===e.length)return this.devId=null,this.devAllList=[],this.devList=[],this.attrList=[],void(this.tableData=[]);var t=this;t.vertical=!1,this.verList.forEach((function(a){a==e[1]&&(t.vertical=!0)})),this.major=e[0],this.typeId=e[2],e[2]&&this.getDev()},getDev:function(){var e,t=this;if(this.major){if("VEHICLE"!==this.major&&this.stationCode)e=this.stationCode;else{if("VEHICLE"!=this.major||!this.trainCode)return t.devId=null,t.devAllList=[],t.devList=[],t.attrList=[],void(t.tableData=[]);e=this.trainCode}this.code=e,this.loading=!0,this.$.ajax({url:"/api/devdata/listdev",type:"post",data:{stationCode:e,typeid:t.typeId,start:0,limit:1e3},success:function(e){e.data&&e.data.records&&e.data.records.length>0?(t.devAllList=e.data.records,t.devList=e.data.records,"VEHICLE"===t.major||t.vertical?t.loading=!1:(t.pageInfo.total=e.data.total,t.devId=e.data.records[0].devId,t.getAttr(e.data.records[0].devId,e.data.records[0].devTypeId))):(t.loading=!1,t.devId=null,t.devAllList=[],t.devList=[],t.attrList=[],t.tableData=[])}})}},getDevPages:function(){var e=this;this.$.ajax({url:"/api/devdata/listdev",type:"post",data:{stationCode:e.code,start:e.pageInfo.currentPage,limit:e.pageInfo.pageSize,typeid:e.typeId},success:function(t){e.loading=!1,e.tableDevList=t.data.records,e.currentDev=e.tableDevList,e.getDevValue(e.currentDev)}})},chooseDev:function(e){var t=this,a=e.devId,i=this.devList;i.forEach((function(i){if(a===i.devId&&1==i.active){if("VEHICLE"===t.major||1==t.vertical)return;i.active=!1,t.loading=!0,t.currentDev=t.tableDevList,t.getDevValue(t.currentDev)}else a===i.devId?(t.loading=!0,i.active=!0,"VEHICLE"===t.major||1==t.vertical?(t.carDev=e,t.carPageInfo.pageSize=20,t.carPageInfo.currentPage=1,t.getCarAttrAndVal()):(t.currentDev=[e],t.getDevValue(t.currentDev))):i.active=!1})),this.devList=[],this.devList=i},getAttr:function(e,t){var a=this;this.$.ajax({url:"/api/devdata/listdevattr",type:"post",data:{devid:e},success:function(e){e.data.forEach((function(e,t){e.sort=t.toString()})),a.getVisibleAttr(e.data,t)}})},getCarAttrAndVal:function(){var e=this;this.$.ajax({url:"/api/devdata/getdevattr",type:"post",data:{major:e.major,devid:e.carDev.devId,start:e.carPageInfo.currentPage,limit:e.carPageInfo.pageSize},success:function(t){t.data&&t.data.data&&t.data.data.length>0?(e.carPageInfo.total=t.data.total,"VEHICLE"===e.major?e.getCarVal(t.data.data):e.getVerticalDevVal(e.carDev.devId,t.data.data),e.showTable=!0):(e.carPageInfo.total=0,e.loading=!1,e.carTableData=[],e.$message({type:"warning",message:"无采集项信息"}))}})},getCarVal:function(e){var t=this;this.$.ajax({url:"/api/devdata/listcollections",type:"post",contentType:"application/json",data:JSON.stringify(e),dataType:"json",success:function(a){t.loading=!1,a.data&&a.data.length>0?(e.forEach((function(e,t){Object.keys(a.data[t]).forEach((function(i){e.value=a.data[t][i]}))})),t.refreshCarData()):t.$message({type:"warning",message:"无采集值"}),t.carTableData=[],t.carTableData=e}})},getVerticalDevVal:function(e,t){var a=this;this.$.ajax({url:"/api/devdata/listdevscollects",type:"post",contentType:"application/json",data:JSON.stringify([e]),dataType:"json",success:function(e){a.loading=!1,e.data&&e.data.length>0?(t.forEach((function(t,a){Object.keys(e.data[a]).forEach((function(i){t.value=e.data[a][i]}))})),a.refreshCarData()):a.$message({type:"warning",message:"无采集值"}),a.carTableData=[],a.carTableData=t}})},getVisibleAttr:function(e,t){var a=this;this.$.ajax({url:"/api/devdata/getvisible",type:"post",data:{typeid:t},success:function(t){t.data&&t.data.length>0?(a.visibleAttrList=t.data,a.visibleAttrList.forEach((function(t){e.forEach((function(e){t.keyId==e.sort&&(e.id=t.id,e.visible=!0)}))}))):a.visibleAttrList=[],a.attrList=e,a.initTableInfo(),a.showTable=!0}})},updateVisible:function(){var e=this,t=this.chooseAttrData,a=this;if(t&&t.length>0){this.loading=!0;var i=[];this.attrList.forEach((function(a){var r=0;t.forEach((function(e){a.sort==e.sort&&(r=1)})),i.push({id:a.id,typeId:e.typeId,isVisible:r,keyId:a.sort})})),this.$.ajax({type:"post",url:"/api/devdata/updatevisible",contentType:"application/json",data:JSON.stringify(i),dataType:"json",success:function(e){a.loading=!1,"0000"==e.code?(a.attrVisible=!1,a.getAttr(a.devId,a.typeId),a.$message({type:"success",message:"保存成功"})):a.$message({type:"warning",message:e.msg})}})}else this.$message({type:"warning",message:"请选择采集项"})},initAttrChoose:function(){var e=this;this.$nextTick((function(){for(var t=0;t<e.attrList.length;t++)e.$refs.attrList.toggleRowSelection(e.attrList[t],!0)}))},showVisible:function(){var e=this;this.$nextTick((function(){for(var t=0;t<e.attrList.length;t++)e.$refs.attrList.toggleRowSelection(e.attrList[t],1==e.attrList[t].visible)}))},chooseVisibleAttr:function(e){this.loading=!1,this.attrVisible=e;this.defaultHeader;e?this.showVisible():this.initAttrChoose()},selectAllAttr:function(e){this.attrVisible=!1,e.sort((function(e,t){return Number(e.sort)>Number(t.sort)?1:Number(e.sort)<Number(t.sort)?-1:0})),this.chooseAttrData=e;var t=[];t.push(this.defaultHeader[0]),t.push(this.defaultHeader[1]),e.length>0&&e.forEach((function(e){var a=e.KEY_ID.split(".");e.grey=Number(a[a.length-1])>=0,t.push(e)})),this.headerData=[],this.headerData=t},selectAttr:function(e){e.sort((function(e,t){return Number(e.sort)>Number(t.sort)?1:Number(e.sort)<Number(t.sort)?-1:0})),this.chooseAttrData=e;var t=[];t.push(this.defaultHeader[0]),t.push(this.defaultHeader[1]),e.length>0&&e.forEach((function(e){var a=e.KEY_ID.split(".");e.grey=Number(a[a.length-1])>0,t.push(e)})),this.headerData=[],this.headerData=t},initTableInfo:function(){this.pageInfo.total<=10?(this.tableDevList=this.devList,this.currentDev=this.tableDevList,this.visibleAttrList.length>0?this.chooseVisibleAttr(!0):this.chooseVisibleAttr(!1),this.getDevValue(this.currentDev)):(this.visibleAttrList.length>0?this.chooseVisibleAttr(!0):this.chooseVisibleAttr(!1),this.getDevPages())},getDevValue:function(e){var t=[];e.forEach((function(e){t.push({devId:e.devId})}));var a=this;this.$.ajax({type:"post",url:"/api/devdata/listdevscollects",contentType:"application/json",data:JSON.stringify(t),dataType:"json",success:function(e){a.loading=!1,a.valData=e.data,a.valData?(a.refreshData(),a.drawVal(a.valData)):(a.tableData=[],a.$message({type:"warning",message:"无采集数据"}))}})},drawVal:function(e){var t=[];Object.keys(e).forEach((function(e){t.push({devId:e})})),this.devAllList.forEach((function(e){t.forEach((function(t){t.devId===e.devId&&(t.devName=e.devName)}))})),t.forEach((function(t,a){e[t.devId].forEach((function(e,a){t[a]=e||"无数据"}))})),this.tableData=[],this.tableData=t},handleCurrentChange:function(e){var t=this.devList;t.forEach((function(e){e.active=!1})),this.devList=[],this.devList=t,this.pageInfo.currentPage=e,this.getDevPages()},handleCarCurrentChange:function(e){this.carPageInfo.currentPage=e,this.getCarAttrAndVal()},handleCarSizeChange:function(e){this.carPageInfo.pageSize=e,this.getCarAttrAndVal()}}}),n=s,o=(a("549f"),a("2877")),l=Object(o["a"])(n,i,r,!1,null,"6f27183a",null);t["default"]=l.exports},"85f2":function(e,t,a){e.exports=a("454f")},"8b97":function(e,t,a){var i=a("d3f4"),r=a("cb7c"),s=function(e,t){if(r(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{i=a("9b43")(Function.call,a("11e9").f(Object.prototype,"__proto__").set,2),i(e,[]),t=!(e instanceof Array)}catch(r){t=!0}return function(e,a){return s(e,a),t?e.__proto__=a:i(e,a),e}}({},!1):void 0),check:s}},9093:function(e,t,a){var i=a("ce10"),r=a("e11e").concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},aa77:function(e,t,a){var i=a("5ca1"),r=a("be13"),s=a("79e5"),n=a("fdef"),o="["+n+"]",l="​",c=RegExp("^"+o+o+"*"),d=RegExp(o+o+"*$"),u=function(e,t,a){var r={},o=s((function(){return!!n[e]()||l[e]()!=l})),c=r[e]=o?t(h):n[e];a&&(r[a]=c),i(i.P+i.F*o,"String",r)},h=u.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(d,"")),e};e.exports=u},aae3:function(e,t,a){var i=a("d3f4"),r=a("2d95"),s=a("2b4c")("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==r(e))}},ac6a:function(e,t,a){for(var i=a("cadf"),r=a("0d58"),s=a("2aba"),n=a("7726"),o=a("32e9"),l=a("84f2"),c=a("2b4c"),d=c("iterator"),u=c("toStringTag"),h=l.Array,v={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=r(v),p=0;p<f.length;p++){var g,m=f[p],b=v[m],y=n[m],L=y&&y.prototype;if(L&&(L[d]||o(L,d,h),L[u]||o(L,u,m),l[m]=h,b))for(g in i)L[g]||s(L,g,i[g],!0)}},b0c5:function(e,t,a){"use strict";var i=a("520a");a("5ca1")({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},bd86:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a("85f2"),r=a.n(i);function s(e,t,a){return t in e?r()(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},c5f6:function(e,t,a){"use strict";var i=a("7726"),r=a("69a8"),s=a("2d95"),n=a("5dbc"),o=a("6a99"),l=a("79e5"),c=a("9093").f,d=a("11e9").f,u=a("86cc").f,h=a("aa77").trim,v="Number",f=i[v],p=f,g=f.prototype,m=s(a("2aeb")(g))==v,b="trim"in String.prototype,y=function(e){var t=o(e,!1);if("string"==typeof t&&t.length>2){t=b?t.trim():h(t,3);var a,i,r,s=t.charCodeAt(0);if(43===s||45===s){if(a=t.charCodeAt(2),88===a||120===a)return NaN}else if(48===s){switch(t.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+t}for(var n,l=t.slice(2),c=0,d=l.length;c<d;c++)if(n=l.charCodeAt(c),n<48||n>r)return NaN;return parseInt(l,i)}}return+t};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof f&&(m?l((function(){g.valueOf.call(a)})):s(a)!=v)?n(new p(y(t)),a,f):y(t)};for(var L,I=a("9e1e")?c(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;I.length>C;C++)r(p,L=I[C])&&!r(f,L)&&u(f,L,d(p,L));f.prototype=g,g.constructor=f,a("2aba")(i,v,f)}},cce0:function(e,t,a){},cd1c:function(e,t,a){var i=a("e853");e.exports=function(e,t){return new(i(e))(t)}},e050:function(e,t,a){"use strict";var i=a("f70e"),r=a.n(i);r.a},e853:function(e,t,a){var i=a("d3f4"),r=a("1169"),s=a("2b4c")("species");e.exports=function(e){var t;return r(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!r(t.prototype)||(t=void 0),i(t)&&(t=t[s],null===t&&(t=void 0))),void 0===t?Array:t}},f70e:function(e,t,a){},fdef:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);